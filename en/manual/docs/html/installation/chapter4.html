<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta xmlns=""
          http-equiv="Content-Type" content="text/html;
          charset=utf-8"/><title>Chapter 4. eformsign Installation and Configuration</title><link rel="stylesheet" href="../stylesheet.css" type="text/css"/><meta name="generator" content="DocBook XSL Stylesheets V1.72.0"/><link rel="start" href="index.html" title="eformsign 설치 안내서"/><link rel="up" href="index.html" title="eformsign 설치 안내서"/><link rel="prev" href="chapter3.html" title="Chapter 3. Pre-installation Task 2: Server Environment Configuration"/><link rel="next" href="chapter5.html" title="Chapter 5. Company Registration"/></head><body><div xmlns="" class="navheader"><table width="100%" summary="Navigation header"><tr><td class="navbar-title" colspan="3" align="center">Chapter 4. eformsign Installation and Configuration</td></tr><tr><td width="20%" align="left"><a accesskey="p" href="chapter3.html">Prev</a> </td><td class="navbar-title" width="60%" align="center"> </td><td width="20%" align="right"> <a accesskey="n" href="chapter5.html">Next</a></td></tr></table><hr/></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a id="chapter4"/>Chapter 4. eformsign Installation and Configuration</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="chapter4.html#eformsign_install">4.1. Installing eformsign</a></span></dt><dd><dl><dt><span class="section"><a href="chapter4.html#d5e636">4.1.1. Pre-installation Tasks</a></span></dt><dt><span class="section"><a href="chapter4.html#eformsign_unzip">4.1.2. Extracting eformsign</a></span></dt><dt><span class="section"><a href="chapter4.html#storage_config">4.1.3. Configuring the Storage</a></span></dt><dt><span class="section"><a href="chapter4.html#upzip">4.1.4. Extracting Daemon, Iam, and Service</a></span></dt><dt><span class="section"><a href="chapter4.html#server_stop">4.1.5. Stopping the Servers</a></span></dt></dl></dd><dt><span class="section"><a href="chapter4.html#encoding">4.2. Encryption Settings</a></span></dt><dd><dl><dt><span class="section"><a href="chapter4.html#rs256">4.2.1. Encrypting Your Account and Generating Key Files</a></span></dt></dl></dd><dt><span class="section"><a href="chapter4.html#db_config">4.3. Configuring CouchDB</a></span></dt><dd><dl><dt><span class="section"><a href="chapter4.html#d5e700">4.3.1. Creating the init-data Folder and Copying CouchDB Files</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e707">4.3.2. Extracting Files</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e712">4.3.3. Copying the Configuration File</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e717">4.3.4. Modifying the eformsign-couchdb-restore File</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e724">4.3.5. Granting Execution Permission</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e729">4.3.6. Executing the Script</a></span></dt></dl></dd><dt><span class="section"><a href="chapter4.html#iam_config">4.4. Configuring Iam</a></span></dt><dd><dl><dt><span class="section"><a href="chapter4.html#iam_foldercopy">4.4.1. Go to the Iam/WEB-INF Folder</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e756">4.4.2. Configuring Properties</a></span></dt><dt><span class="section"><a href="chapter4.html#key_copy">4.4.3. Copying the Encryption Key Files (RS256.private,
      RS256.pub)</a></span></dt></dl></dd><dt><span class="section"><a href="chapter4.html#service_config">4.5. Configuring Service</a></span></dt><dd><dl><dt><span class="section"><a href="chapter4.html#service_foldercopy">4.5.1. Go to the Service/WEB-INF/classes Folder</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e807">4.5.2. Configuring Properties</a></span></dt><dt><span class="section"><a href="chapter4.html#pub_key_copy">4.5.3. Copying the Encryption Key File (RS256.pub)</a></span></dt></dl></dd><dt><span class="section"><a href="chapter4.html#daemon_config">4.6. Configuring the Daemon</a></span></dt><dd><dl><dt><span class="section"><a href="chapter4.html#daemon_foldercopy">4.6.1. Go to the Daemon/WEB-INF/classes Folder</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e884">4.6.2. Configuring Properties</a></span></dt></dl></dd><dt><span class="section"><a href="chapter4.html#home_config">4.7. Configuring Home</a></span></dt><dd><dl><dt><span class="section"><a href="chapter4.html#home_upzip">4.7.1. Extracting the Home File</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e935">4.7.2. Configuring the Version</a></span></dt></dl></dd><dt><span class="section"><a href="chapter4.html#license_config">4.8. Configuring ozconfig</a></span></dt><dt><span class="section"><a href="chapter4.html#license_config">4.9. Configuring the License</a></span></dt><dt><span class="section"><a href="chapter4.html#proxy_config">4.10. Configuring the Proxy</a></span></dt><dd><dl><dt><span class="section"><a href="chapter4.html#d5e993">4.10.1. Configuring nginx</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e1024">4.10.2. Configuring Tomcat</a></span></dt></dl></dd><dt><span class="section"><a href="chapter4.html#execute_config">4.11. Configuring GZIP</a></span></dt><dt><span class="section"><a href="chapter4.html#execute_config">4.12. Configuring Startup</a></span></dt><dd><dl><dt><span class="section"><a href="chapter4.html#d5e1055">4.12.1. Running the Servers</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e1060">4.12.2. Service</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e1065">4.12.3. Daemon</a></span></dt><dt><span class="section"><a href="chapter4.html#d5e1070">4.12.4. Iam</a></span></dt></dl></dd></dl></div>
  

  <p>This chapter describes how to install eformsign and configure its
  properties.</p>

  <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">Note</h3>
    <p>To install and run eformsign, the web server, WAS, and DB must be
    installed beforehand.</p>

    <p>For information about how to install them, refer to <a href="chapter3.html" title="Chapter 3. Pre-installation Task 2: Server Environment Configuration">“Chapter 3. Pre-installation Task 2: Server Environment Configuration”</a>.</p>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="eformsign_install"/>4.1. Installing eformsign</h2></div></div></div>
    

    <p>This section describes how to install eformsign.</p>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e636"/>4.1.1. Pre-installation Tasks</h3></div></div></div>
      

      <p>Copy the default configuration file by executing the following
      command.</p>

      <pre class="programlisting">$ mkdir /opt/eformsign
$ cd /opt/eformsign
// Copy the compressed file you received to the current folder. '10,2020,0429,300' is the build version and the file name may vary.
$ cp Onpremise-10,2020,0429,300.zip
</pre>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="eformsign_unzip"/>4.1.2. Extracting eformsign</h3></div></div></div>
      

      <p>Extract the<span class="bold"><strong>
      Onpremise-10,2020,0429,300.zip</strong></span> file by executing the
      following command.</p>

      <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">Note</h3>
        <p>10,2020,0429,300 is the build version and the file name may
        differ.</p>
      </div>

      <pre class="programlisting">$ unzip Onpremise-10,2020,0429,300.zip</pre>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="storage_config"/>4.1.3. Configuring the Storage</h3></div></div></div>
      

      <p>Configure the storage to be used by eformsign.</p>

      <pre class="programlisting">$ cd /opt
$ mkdir storage
$ chown -R tomcat:tomcat storage/
$ chmod -R 750 storage/
$ cd storage
$ unzip /opt/eformsign/storagefiles.zip
</pre>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="upzip"/>4.1.4. Extracting Daemon, Iam, and Service</h3></div></div></div>
      

      <p>Create a folder in webapps in Tomcat and extract the
      Daemon<a id="d5e657" class="indexterm"/>, Iam<a id="d5e659" class="indexterm"/>, and Service<a id="d5e661" class="indexterm"/> files.</p>

      <p>The method of extraction differs for each OS.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>RHEL 7</p>

          <pre class="programlisting">$ cd /opt/tomcat/webapps/
$ rm -rf *
$ mkdir Daemon Iam Service
$ chown -R tomcat:tomcat *
$ chmod –R 750 *
$ cd Daemon
$ unzip /opt/eformsign/Daemon-10,2020,0429,300.war
$ cd ../Iam
$ unzip /opt/eformsign/Iam-10,2020,0429,300.war
$ cd ../Service
$ unzip /opt/eformsign/Service-10,2020,0429,300.war
</pre>
        </li><li>
          <p>CentOS 7</p>

          <pre class="programlisting">$ cd /var/lib/tomcat/webapps
$ rm -rf *
$ mkdir Daemon Iam Service
$ chown -R tomcat:tomcat *
$ chmod –R 750 *
$ cd Daemon
$ unzip /opt/eformsign/Daemon-10,2020,0429,300.war
$ cd ../Iam
$ unzip /opt/eformsign/Iam-10,2020,0429,300.war
$ cd ../Service
$ unzip /opt/eformsign/Service-10,2020,0429,300.war
</pre>
        </li><li>
          <p>Debian 10</p>

          <pre class="programlisting">$ cd /opt/tomcat/latest/webapps/
$ rm -rf *
$ mkdir Daemon Iam Service
$ chown -R tomcat:tomcat *
$ chmod –R 750 *
$ cd Daemon
$ unzip /opt/eformsign/Daemon-10,2020,0429,300.war
$ cd ../Iam
$ unzip /opt/eformsign/Iam-10,2020,0429,300.war
$ cd ../Service
$ unzip /opt/eformsign/Service-10,2020,0429,300.war
</pre>
        </li></ul></div>

      <p/>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="server_stop"/>4.1.5. Stopping the Servers</h3></div></div></div>
      

      <p>To configure the server environments, stop the web server, WAS,
      and DB server that are installed and running.</p>

      <pre class="programlisting">$ service nginx stop
$ service tomcat stop
$ service couchdb stop</pre>
    </div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="encoding"/>4.2. Encryption Settings</h2></div></div></div>
    

    <p>Encrypt your account and generate encryption key files.</p>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="rs256"/>4.2.1. Encrypting Your Account and Generating Key Files</h3></div></div></div>
      

      <p>Encrypt your account by executing the following command and write
      a memo of the result. The information of the encrypted account will be
      displayed and the key files, RS256.private<a id="d5e689" class="indexterm"/>and RS256.pub<a id="d5e691" class="indexterm"/>, will be generated.</p>

      <pre class="programlisting">$ cd /opt/eformsign
$ java -jar eformsignGen.jar init
Enter couchdb ID : CouchDB ID
Enter couchdb Password : CouchDB PW
Enter email ID : email ID
Enter email Password : email PW
</pre>
    </div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="db_config"/>4.3. Configuring CouchDB</h2></div></div></div>
    

    <p>eformsign's data can be stored and managed in a DB by configuring
    CouchDB<a id="d5e698" class="indexterm"/>.</p>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e700"/>4.3.1. Creating the init-data Folder and Copying CouchDB Files</h3></div></div></div>
      

      <p>Create the init-data<a id="d5e703" class="indexterm"/> folder and copy CouchDB files to the eformsign
      folder.</p>

      <pre class="programlisting">$ cd /opt/couchdb
$ mkdir init-data
$ cd init-data/
$ cp /opt/eformsign/eformsign-couchdb-* .
</pre>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e707"/>4.3.2. Extracting Files</h3></div></div></div>
      

      <p>Extract CouchDB files by executing the following command.</p>

      <pre class="programlisting">$ tar -zxvf eformsign-couchdb-default-data.tar.gz</pre>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e712"/>4.3.3. Copying the Configuration File</h3></div></div></div>
      

      <p>Copy the default configuration file by executing the following
      commands.</p>

      <pre class="programlisting">$ cp eformsign-couchdb-backup eformsign-couchdb-default-data
$ cp eformsign-couchdb-restore eformsign-couchdb-default-data
$ cd eformsign-couchdb-default-data
</pre>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e717"/>4.3.4. Modifying the eformsign-couchdb-restore File</h3></div></div></div>
      

      <p>Modify the eformsign-couchdb-restore<a id="d5e720" class="indexterm"/> file by executing the following command.</p>

      <pre class="programlisting">$ vi eformsign-couchdb-restore
./eformsign-couchdb-backup -r -H localhost -d $filename -f $f -u admin -p password -q -c  // Enter couchdbID, couchdbPW in admin, password
</pre>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e724"/>4.3.5. Granting Execution Permission</h3></div></div></div>
      

      <p>Grant execution permission for CouchDB.</p>

      <pre class="programlisting">$ chmod +x eformsign-couchdb-*</pre>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e729"/>4.3.6. Executing the Script</h3></div></div></div>
      

      <p>Restart CouchDB.</p>

      <pre class="programlisting">$ service couchdb restart
$ curl -X PUT http://admin:password@localhost:8308/_users // Enter couchdbID:couchdbPW in admin:password.
$ curl -X PUT http://admin:password@localhost:8308/_replicator // Enter couchdbID:couchdbPW in admin:password.
$ ./eformsign-couchdb-restore
</pre>
    </div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="iam_config"/>4.4. Configuring Iam</h2></div></div></div>
    

    <p>Iam<a id="d5e737" class="indexterm"/> server is a server that manages user accounts in the Oauth
    method. Configure it in the following order.</p>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="iam_foldercopy"/>4.4.1. Go to the Iam/WEB-INF Folder</h3></div></div></div>
      

      <p>Go to the WEB-INF folder in Iam by executing the following command
      for each OS.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>RHEL 7</p>

          <pre class="programlisting">$ cd /opt/tomcat/webapps/Iam/WEB-INF</pre>
        </li><li>
          <p>CentOS 7</p>

          <pre class="programlisting">$ cd /var/lib/tomcat/webapps/Iam/WEB-INF</pre>
        </li><li>
          <p>Debian 10</p>

          <pre class="programlisting">$ cd /opt/tomcat/latest/webapps/Iam/WEB-INF</pre>
        </li></ul></div>

      <p/>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e756"/>4.4.2. Configuring Properties</h3></div></div></div>
      

      <p>Modify the config.properties<a id="d5e759" class="indexterm"/> file as follows.</p>

      <pre class="programlisting">$ vi config.properties
...
// Enter the mail part
mail.host=
mail.username=
mail.password=
mail.port=
mail.smtp.auth=
mail.smtp.starttls.enable=
mail.from.address=
mail.from.name=
mail.html=

mail.contacts.address=&lt;enter the user account&gt;
mail.redirect.address=&lt;enter the domain or IP address&gt;

###########################################
## DataSource Configuration
###########################################
couch.db.url=http://localhost:8308
couch.db.username= CouchDB ID       // Enter CouchDB Id, PW in couch.db.username, couch.db.password
couch.db.password= CouchDB PW
couch.db.database=forcs_iam
couch.db.autoview=true
</pre>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="key_copy"/>4.4.3. Copying the Encryption Key Files (RS256.private,
      RS256.pub)</h3></div></div></div>
      

      <p>Copy the <a href="chapter4.html#rs256" title="4.2.1. Encrypting Your Account and Generating Key Files">“4.2.1. Encrypting Your Account and Generating Key Files”</a>, RS256.private<a id="d5e767" class="indexterm"/> and RS256.pub<a id="d5e769" class="indexterm"/> files by executing the following commands.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>RHEL 7</p>

          <pre class="programlisting">$ cd /opt/tomcat/webapps/Iam/WEB-INF/classes/jwt-keys
$ rm -rf *
$ cp /opt/eformsign/app/RS256.* .
</pre>
        </li><li>
          <p>CentOS 7</p>

          <pre class="programlisting">$ cd /var/lib/tomcat/webapps/Iam/WEB-INF/classes/jwt-keys
$ rm -rf *
$ cp /opt/eformsign/RS256.* .
</pre>
        </li><li>
          <p>Debian 10</p>

          <pre class="programlisting">$ cd /opt/tomcat/latest/webapps/Iam/WEB-INF/classes/jwt-keys
$ rm -rf *
$ cp /opt/eformsign/RS256.* .
</pre>
        </li></ul></div>

      <p/>
    </div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="service_config"/>4.5. Configuring Service</h2></div></div></div>
    

    <p>Service<a id="d5e788" class="indexterm"/> server is a server that synchronously responds to user
    requests, and is run on the WAS. Configure it as follows.</p>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="service_foldercopy"/>4.5.1. Go to the Service/WEB-INF/classes Folder</h3></div></div></div>
      

      <p>Go to the Service/WEB-INF/classes folder in webapps in
      Tomcat.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>RHEL 7</p>

          <pre class="programlisting">$ cd /opt/tomcat/webapps/Service/WEB-INF/classes</pre>
        </li><li>
          <p>CentOS 7</p>

          <pre class="programlisting">$ cd /var/lib/tomcat/webapps/Service/WEB-INF/classes</pre>
        </li><li>
          <p>Debian 10</p>

          <pre class="programlisting">$ cd /opt/tomcat/latest/webapps/Service/WEB-INF/classes</pre>
        </li></ul></div>

      <p/>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e807"/>4.5.2. Configuring Properties</h3></div></div></div>
      

      <p>Modify the aes256.properties, couchDB.properties,
      forcsCom.properties, storageConfig.xml, and email.properties files as
      follows.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>aes256.properties<a id="d5e813" class="indexterm"/></p>

          <pre class="programlisting">$ vi aes256.properties
// Enter the encryption key generated in '4.2.1. Encrypting Your Account and Generating a Key File'.
aeskey.couchdb= 
aeskey.api= 
aeskey.webhook= 
aeskey.email=
</pre>
        </li><li>
          <p>couchDB.properties<a id="d5e819" class="indexterm"/></p>

          <pre class="programlisting">$ vi couchDB.properties
// Enter the encryption key generated in '4.2.1. Encrypting Your Account and Generating a Key File'.
db.id_encrypted=
db.password_encrypted=
...
server.type=onpremise
server.service_url=http://Domain or ip/Service
server.daemon_url=http://Domain or ip/Daemon
server.home_url=http://Domain or ip
service.language=ko-kr,ja-jp,en-us
</pre>
        </li><li>
          <p>forcsCom.properties<a id="d5e825" class="indexterm"/></p>

          <pre class="programlisting">$ vi forcsCom.properties
// Enter the encryption key generated in '4.2.1. Encrypting Your Account and Generating a Key File'.
db.id_encrypted=
db.password_encrypted= 
</pre>
        </li><li>
          <p>storageConfig.xml<a id="d5e831" class="indexterm"/></p>

          <pre class="programlisting">$ vi storageConfig.xml
…
&lt;!-- file system --&gt;
        &lt;bean id="storageService" class="oz.service.storage.impl.FileSystemServiceImpl"&gt;
                &lt;constructor-arg name="_root_path" value=""/&gt;             //Enter the storage path in the value of _root_path
                &lt;constructor-arg name="_imgUrl" value=""/&gt;              //Enter the domain/Service in the value in _imgUrl 
        &lt;/bean&gt;
…
</pre>
        </li><li>
          <p>email.properties<a id="d5e837" class="indexterm"/></p>

          <pre class="programlisting">$ vi email.properties
host : Enter the mail server host
port : Enter the mail server port
account : Enter the mail account
password : Enter the mail password
prefix : Enter the header(optional)
ssl : Configure by mail server (true / false)
// Enter the encryption key generated in '4.2.1. Encrypting Your Account and Generating a Key File'
account_encrypted : 
password_encrypted : 
</pre>
        </li></ul></div>

      <p/>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="pub_key_copy"/>4.5.3. Copying the Encryption Key File (RS256.pub)</h3></div></div></div>
      

      <p>Copy the <a href="chapter4.html#rs256" title="4.2.1. Encrypting Your Account and Generating Key Files">“4.2.1. Encrypting Your Account and Generating Key Files”</a>, RS256.pub<a id="d5e846" class="indexterm"/> file by executing the following command.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>RHEL 7</p>

          <pre class="programlisting">$ cd /opt/tomcat/webapps/Service/WEB-INF/classes/jwt-keys
$ rm -rf *
$ cp /opt/eformsign/RS256.pub .
</pre>
        </li><li>
          <p>CentOS 7</p>

          <pre class="programlisting">$ cd /var/lib/tomcat/webapps/Service/WEB-INF/classes/jwt-keys
$ rm -rf *
$ cp /opt/eformsign/RS256.pub .
</pre>
        </li><li>
          <p>Debian 10</p>

          <pre class="programlisting">$ cd /opt/tomcat/latest/webapps/Service/WEB-INF/classes/jwt-keys
$ rm -rf *
$ cp /opt/eformsign/RS256.pub .
</pre>
        </li></ul></div>

      <p/>
    </div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="daemon_config"/>4.6. Configuring the Daemon</h2></div></div></div>
    

    <p>The Daemon<a id="d5e865" class="indexterm"/> server is a server that asynchronously responds to batch
    and scheduler tasks such as email notification, bulk creation of
    documents, and generation of PDF documents. Same as the Service server, it
    is run on the WAS. Configure it as follows.</p>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="daemon_foldercopy"/>4.6.1. Go to the Daemon/WEB-INF/classes Folder</h3></div></div></div>
      

      <p>Go to the Daemon/WEB-INF/classes folder in webapps in
      Tomcat.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>RHEL 7</p>

          <pre class="programlisting">$ cd /opt/tomcat/webapps/Daemon/WEB-INF/classes</pre>
        </li><li>
          <p>CentOS 7</p>

          <pre class="programlisting">$ cd /var/lib/tomcat/webapps/Daemon/WEB-INF/classes</pre>
        </li><li>
          <p>Debian 10</p>

          <pre class="programlisting">$ cd /opt/tomcat/latest/webapps/Daemon/WEB-INF/classes</pre>
        </li></ul></div>

      <p/>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e884"/>4.6.2. Configuring Properties</h3></div></div></div>
      

      <p>Modify each one of aes256.properties, couchDB.properties,
      forcsCom.properties, storageConfig.xml, and email.properties files as
      follows.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>aes256.properties<a id="d5e890" class="indexterm"/></p>

          <pre class="programlisting">$ vi aes256.properties
// Enter the encryption key generated in '4.2.1. Encrypting Your Account and Generating a Key File'
aeskey.couchdb= 
aeskey.api= 
aeskey.webhook= 
aeskey.email= 
</pre>
        </li><li>
          <p>couchDB.properties<a id="d5e896" class="indexterm"/></p>

          <pre class="programlisting">$ vi couchDB.properties
// Enter the encryption key generated in '4.2.1. Encrypting Your Account and Generating a Key File'
db.id_encrypted= 
db.password_encrypted= 
...
server.type=onpremise
server.service_url=http://Domain or ip/Service
server.daemon_url=http://Domain or ip/Daemon
server.home_url=http://Domain or ip
service.language=ko-kr,ja-jp,en-us
</pre>
        </li><li>
          <p>forcsCom.properties<a id="d5e902" class="indexterm"/></p>

          <pre class="programlisting">$ vi forcsCom.properties
// Enter the encryption key generated in '4.2.1. Encrypting Your Account and Generating a Key File'
db.id_encrypted= 
db.password_encrypted= 
</pre>
        </li><li>
          <p>storageConfig.xml<a id="d5e908" class="indexterm"/></p>

          <pre class="programlisting">$ vi storageConfig.xml
…
        &lt;bean id="storageService" class="oz.service.storage.impl.FileSystemServiceImpl"&gt;
                &lt;constructor-arg name="_root_path" value=""/&gt;             //Enter the storage path in the value of _root_path.
                &lt;constructor-arg name="_imgUrl" value=""/&gt;              //Enter the domain/Service in the value of_imgUrl.
        &lt;/bean&gt;
…
</pre>
        </li><li>
          <p>email.properties<a id="d5e914" class="indexterm"/></p>

          <pre class="programlisting">$ vi email.properties
host : Enter the mail server host
port : Enter the mail server port
account : Enter the mail account
password : Enter the mail password
prefix : Enter the header(optional)
ssl : Configure according to the mail server (true / false)
// Enter the encryption key generated in '4.2.1. Encrypting Your Account and Generating a Key File'
account_encrypted :
password_encrypted : 
</pre>
        </li></ul></div>

      <p/>
    </div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="home_config"/>4.7. Configuring Home</h2></div></div></div>
    

    <p>This is the screen displayed on the front-end to users and is
    installed on the web server.</p>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="home_upzip"/>4.7.1. Extracting the Home File</h3></div></div></div>
      

      <p>Extract the Home file in nginx.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>RHEL7/CentOS 7</p>

          <pre class="programlisting">$ cd /usr/share/nginx/html
$ rm -rf *
$ tar -zvxf /opt/eformsign/app/home-10,2020,0429,300.tar.gz</pre>
        </li><li>
          <p>Debian 10</p>

          <pre class="programlisting">$ cd /var/www/html
$ rm -rf *
$ tar -zvxf /opt/eformsign/app/home-10,2020,0429,300.tar.gz</pre>
        </li></ul></div>

      <p/>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e935"/>4.7.2. Configuring the Version</h3></div></div></div>
      

      <p>1. To configure the Home version, go to the version folder.</p>

      <div class="itemizedlist"><ul type="disc"><li>
            <p>RHEL 7/CentOS 7</p>

            <pre class="programlisting">$ cd /usr/share/nginx/html/version</pre>
          </li><li>
            <p>Debian 10</p>

            <pre class="programlisting">$ cd /var/www/html/version</pre>
          </li></ul></div><p>2. Open the version10,2020,0429,300.js file.</p>

      <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">Note</h3>
        <p>10,2020,0429,300 is the build version, and the file name may
        differ.</p>
      </div>

      <pre class="programlisting">$ vi version10,2020,****,***.js</pre>

      <p>3. Modify the file as follows.</p>

      <pre class="programlisting">var EFORMSIGN_VERSION="10,2020,****,***";
var OPTION_KO_BLOG_URL="https://www.eformsign.com/kr/blog/";
var OPTION_EN_BLOG_URL="https://www.eformsign.com/en/blog/";
var OPTION_JA_BLOG_URL="https://www.eformsign.com/jp/blog/";
var OPTION_KO_SUPPORT_URL="https://www.eformsign.com/kr/support/";
var OPTION_EN_SUPPORT_URL="https://www.eformsign.com/en/support/";
var OPTION_JA_SUPPORT_URL="https://www.eformsign.com/en/support/";
var OPTION_SERVICE_URL="http://domain/Service";
var OPTION_DAEMON_URL="http://domain/Daemon";
var OPTION_LOCATION_CODE="country code eg) kr";
</pre>
    </div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="license_config"/>4.8. Configuring ozconfig</h2></div></div></div>
    

    <p>1. To configure ozconfig, go to the html folder.</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>RHEL 7/CentOS 7</p>

        <pre class="programlisting">$ cd /usr/share/nginx/html
</pre>
      </li><li>
        <p>Debian 10</p>

        <pre class="programlisting">$ cd /var/www/html
</pre>
      </li></ul></div>

    <p>2. Open the ozconfig.xml file.</p>

    <pre class="programlisting">$ vi ozconfig.xml
</pre>

    <p>3. Modify the file as follows.</p>

    <div class="note" style="margin-left: 0in; margin-right: 0in;"><h3 class="title">Note</h3>
      <p>The localhost must be changed to either the domain or IP.</p>
    </div>

    <pre class="programlisting">&lt;serviceInfo&gt;
&lt;browser&gt;
 &lt;preserveCache&gt;false&lt;/preserveCache&gt;
 &lt;/browser&gt;
 &lt;pageUrls&gt;
 &lt;execution&gt;http://localhost/eform/document/ozinoffice_view_service.html&lt;/execution&gt;
 &lt;download&gt;http://localhost/eform/form/list_form_oz.html&lt;/download&gt;
 &lt;upload&gt;http://localhost/eform/form/check_form_oz.html&lt;/upload&gt;
 &lt;propertyPane&gt;http://localhost/ozinoffice_pages/ozinoffice_prop_panel.html&lt;/propertyPane&gt;
 &lt;/pageUrls&gt;
 &lt;update&gt;
 &lt;addInVersion&gt;80.2020.0422.201&lt;/addInVersion&gt;
 &lt;productVersion&gt;19081901&lt;/productVersion&gt;
 &lt;downloadUrl&gt;http://localhost/development_tools/office/eformsign_form_builder.exe&lt;/downloadUrl&gt;
 &lt;/update&gt;
 &lt;ribbon&gt;
 &lt;documentInfo&gt;true&lt;/documentInfo&gt;
 &lt;/ribbon&gt;
&lt;/serviceInfo&gt;
</pre>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="license_config"/>4.9. Configuring the License</h2></div></div></div>
    

    <p>Go to the folder that contains the license file and set the license
    for each OS as follows.</p>

    <div class="itemizedlist"><ul type="disc"><li>
        <p>RHEL 7</p>

        <pre class="programlisting">$ cp ozlicense.xml eformsignlicense.xml /opt/tomcat/webapps/Service/WEB-INF/classes/
$ cp ozlicense.xml eformsignlicense.xml /opt/tomcat/webapps/Daemon/WEB-INF/classes/
$ cp ozlicense.xml /usr/share/nginx/html/plugins/ozhtml5/license/
$ cp ozuserservicelicense.xml /usr/share/nginx/html/
</pre>
      </li><li>
        <p>CentOS 7</p>

        <pre class="programlisting">$ cp ozlicense.xml eformsignlicense.xml /var/lib/tomcat/webapps/Service/WEB-INF/classes/
$ cp ozlicense.xml eformsignlicense.xml /var/lib/tomcat/webapps/Daemon/WEB-INF/classes/
$ cp ozlicense.xml /usr/share/nginx/html/plugins/ozhtml5/license/
$ cp ozuserservicelicense.xml /usr/share/nginx/html/
</pre>
      </li><li>
        <p>Debian 10</p>

        <pre class="programlisting">$ cp ozlicense.xml eformsignlicense.xml /opt/tomcat/latest/webapps/Service/WEB-INF/classes/
$ cp ozlicense.xml eformsignlicense.xml /opt/tomcat/latest/webapps/Daemon/WEB-INF/classes/
$ cp ozlicense.xml /var/www/html/plugins/ozhtml5/license/
$ cp ozuserservicelicense.xml /var/www/html/
</pre>
      </li></ul></div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="proxy_config"/>4.10. Configuring the Proxy</h2></div></div></div>
    

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e993"/>4.10.1. Configuring nginx</h3></div></div></div>
      

      <p>In RHEL 7 and CentOS 7, modify the server{} part in the
      default.conf file.</p>

      <p>In Debian 10, modify the server{} part in the default file.</p>

      <p>1. Open either the default.conf or default file.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>RHEL 7/CentOS 7</p>

          <pre class="programlisting">$ vi /etc/nginx/conf.d/default.conf</pre>
        </li><li>
          <p>Debian 10</p>

          <pre class="programlisting">$ vi /etc/nginx/sites-available/defult</pre>
        </li></ul></div>

      <p>2. Modify the file as follows.</p>

      <div class="itemizedlist"><ul type="disc"><li>
            <p>RHEL 7/CentOS 7: default.conf file<a id="d5e1012" class="indexterm"/></p>

            <pre class="programlisting">server {
listen 80;
server_name localhost;

#charset koi8-r;
#access_log /var/log/nginx/host.access.log main;

location / {
root /usr/share/nginx/html;
#index index.html index.htm;
index login_private.html;
}

location /Iam {
# forward all request headers to backend
proxy_pass_request_headers on;
# these settings come from the CouchDB wiki
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

root /usr/share/nginx/html;
index index.html index.htm;
proxy_pass http://localhost:8080/Iam;
}

location /Service {
# forward all request headers to backend
proxy_pass_request_headers on;
# these settings come from the CouchDB wiki
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

root /usr/share/nginx/html;
index index.html index.htm;
proxy_pass http://localhost:8080/Service;
}

location /Daemon {
# forward all request headers to backend
proxy_pass_request_headers on;
# these settings come from the CouchDB wiki
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

root /usr/share/nginx/html;
index index.html index.htm;
proxy_pass http://localhost:8080/Daemon;
}

#error_page 404 /404.html;

# redirect server error pages to the static page /50x.html
#</pre>
          </li><li>
            <p>Debian 10: default file<a id="d5e1018" class="indexterm"/></p>

            <pre class="programlisting">server {

....

    location / {

        #index index.html index.htm;
        index login_private.html;

    }

    location /Iam {
        # forward all request headers to backend
        proxy_pass_request_headers on;
        # these settings come from the CouchDB wiki
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

        index index.html index.htm;
        proxy_pass http://localhost:8080/Iam;
    }

    location /Service {
        # forward all request headers to backend
        proxy_pass_request_headers on;
        # these settings come from the CouchDB wiki
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

        index index.html index.htm;
        proxy_pass http://localhost:8080/Service;
    }

    location /Daemon {
        # forward all request headers to backend
        proxy_pass_request_headers on;
        # these settings come from the CouchDB wiki
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

        index index.html index.htm;
        proxy_pass http://localhost:8080/Daemon;

    }

...</pre>
          </li></ul></div>

      <p/>

      <p/>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e1024"/>4.10.2. Configuring Tomcat</h3></div></div></div>
      

      <p>1. Open server.xml in Tomcat.</p>

      <div class="itemizedlist"><ul type="disc"><li>
          <p>RHEL 7/CentOS 7</p>

          <pre class="programlisting">$ vi /opt/tomcat/conf/server.xml </pre>
        </li><li>
          <p>CentOS 7</p>

          <pre class="programlisting">$ vi /etc/tomcat/server.xml</pre>
        </li><li>
          <p>Debian 10</p>

          <pre class="programlisting">$ vi /opt/tomcat/latest/conf/server.xml</pre>
        </li></ul></div>

      <p>2. Modify the server.xml<a id="d5e1041" class="indexterm"/> file as follows.</p>

      <pre class="programlisting">&lt;Host name="localhost" appBase="webapps"

unpackWARs="true" autoDeploy="true"&gt;

&lt;Context docBase="Iam" path="/Iam"/&gt;
&lt;Context docBase="Service" path="/Service"/&gt;
&lt;Context docBase="Daemon" path="/Daemon" /&gt;
&lt;!-- SingleSignOn valve, share authentication between web applications
Documentation at: /docs/config/valve.html --&gt;
&lt;!--
&lt;Valve className="org.apache.catalina.authenticator.SingleSignOn" /&gt;
--&gt;

&lt;!-- Access log processes all example.
Documentation at: /docs/config/valve.html
Note: The pattern used is equivalent to using pattern="common" --&gt;
&lt;Valve className="org.apache.catalina.valves.AccessLogValve" directory="logs"
prefix="localhost_access_log" suffix=".txt"
pattern="%h %l %u %t &amp;quot;%r&amp;quot; %s %b" /&gt;
&lt;/Host&gt;</pre>

      <p/>
    </div>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="execute_config"/>4.11. Configuring GZIP</h2></div></div></div>
    

    <p>1. Open the nginx.conf file in nginx.</p>

    <pre class="programlisting">$ vi /etc/nginx/nginx.conf</pre>

    <p>2. Modify the nginx.conf file as follows.</p>

    <pre class="programlisting">...
http {
...
    gzip on;
gzip_vary on;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_buffers 16 8k;
    gzip_http_version 1.1;
    gzip_types text/html text/plain text/css application/json application/javascript text/xml;
    client_max_body_size 100M;
...
}
</pre>
  </div>

  <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="execute_config"/>4.12. Configuring Startup</h2></div></div></div>
    

    <p>Check whether the Service, Daemon, and Iam servers are installed and
    configured normally.</p>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e1055"/>4.12.1. Running the Servers</h3></div></div></div>
      

      <p>Start each server.</p>

      <pre class="programlisting">Service nginx start
Service couchdb start
Service tomcat start
</pre>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e1060"/>4.12.2. Service</h3></div></div></div>
      

      <p>Enter the IP address/Service in the web browser, and check whether
      the following execution result is displayed.</p>

      <pre class="programlisting">{"Service Name":"Service","eformsign version":"10,2020,0429,300","Viewer version":"80,2020,0422,201","Server version":"80,2020,0422,1510","Cpu Count":"any","IP List":"any","Request URL":"any",
"Expire Date":"2021-05-01"}
</pre>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e1065"/>4.12.3. Daemon</h3></div></div></div>
      

      <p>Enter the IP address/Daemon in the web browser, and check whether
      the following execution result is displayed.</p>

      <pre class="programlisting">{"Service Name":"Service","eformsign version":"10,2020,0429,300","Viewer version":"80,2020,0422,201","Server version":"80,2020,0422,1510","Cpu Count":"any","IP List":"any","Request URL":"any",
"Expire Date":"2021-05-01"}
</pre>
    </div>

    <div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="d5e1070"/>4.12.4. Iam</h3></div></div></div>
      

      <p>Enter the IP address/Iam in the web browser, and check whether the
      Iam login page is displayed.</p>
    </div>
  </div>
</div><div class="navfooter"><hr/><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="chapter3.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="chapter5.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 3. Pre-installation Task 2: Server Environment Configuration </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 5. Company Registration</td></tr></table></div><div xmlns="" align="center"/></body></html>